<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>BinButler Service Signup</title>
  <link rel="stylesheet" href="loggedin.css" />
  <link rel="icon" type="image/png" href="favicon.png" />
</head>

<body>
  <div class="container">
    <div class="header">
      <h1 class="logo"><span>Bin</span>Butler</h1>
      <h1>Service Signup</h1>
    </div>

    <main>
      <form
        id="signupForm"
        action="https://script.google.com/macros/s/AKfycbzYpFlcv6gi0G4wC7nmWIit1oOKF75fxKoT6YFmaugQIZ1D8AFC4p9aUb5j-fT0oNvUOw/exec"
        method="POST"
      >
        <!-- Question 1 -->
        <section>
          <h2>1. What is your address for bin service?</h2>
          <input type="text" name="address" placeholder="Enter your address" required />
        </section>

        <!-- Question 2 -->
        <section>
          <h2>2. Where are the bins currently located on your property?</h2>
          <select id="bin_location" name="bin_location" required>
            <option value="" disabled selected>Select bin location</option>
            <option value="backyard">Backyard</option>
            <option value="side_yard">Side Yard</option>
            <option value="garage">Garage</option>
            <option value="other">Other</option>
          </select>
          <input
            type="text"
            id="other_location"
            name="other_location"
            placeholder="Please specify..."
            style="display:none; margin-top:10px;"
            aria-hidden="true"
          />
        </section>

        <!-- Question 3 -->
        <section>
          <h2>3. Do you have pets we should be aware of?</h2>
          <select name="pets" required>
            <option value="" disabled selected>Select an option</option>
            <option value="yes">Yes</option>
            <option value="no">No</option>
          </select>
        </section>

        <!-- Question 4 -->
        <section>
          <h2>4. What is your preferred payment method?</h2>
          <select name="payment_method" required>
            <option value="" disabled selected>Select a payment method</option>
            <option value="PayPal">PayPal</option>
            <option value="Cash">Cash</option>
          </select>
        </section>

        <!-- Question 5 -->
        <section>
          <h2>5. What is your preferred contact method?</h2>
          <select name="contact_method" required>
            <option value="" disabled selected>Select a contact method</option>
            <option value="email">Email</option>
            <option value="text">Messenger</option>
          </select>
          <input type="text" name="contact_info" placeholder="Enter your phone or email" required />
        </section>

        <!-- Question 6 -->
        <section>
          <h2>6. Do we have permission to access your property?</h2>
          <select name="property_access" required>
            <option value="" disabled selected>Select an option</option>
            <option value="yes">Yes</option>
          </select>
        </section>

        <section>
          <button type="submit">Submit</button>
        </section>
      </form>

      <div id="success-message" style="display: none;">
        <h2>Thank you! We’ve received your info!</h2>
        <p>We’ll contact you soon to start your BinButler service!</p>
      </div>
    </main>
  </div>

  <script>
    document.addEventListener("DOMContentLoaded", function () {
      const binSelect = document.getElementById("bin_location");
      const otherInput = document.getElementById("other_location");
      const form = document.getElementById("signupForm");

      function toggleOtherField() {
        if (binSelect.value === "other") {
          otherInput.style.display = "block";
          otherInput.required = true;
        } else {
          otherInput.style.display = "none";
          otherInput.required = false;
          otherInput.value = "";
        }
      }

      binSelect.addEventListener("change", toggleOtherField);
      toggleOtherField();

      form.addEventListener("submit", function (e) {
        e.preventDefault();
        const formData = new FormData(form);

        if (formData.get("bin_location") === "other") {
          const otherVal = formData.get("other_location").trim();
          if (otherVal) {
            formData.set("bin_location", otherVal);
          }
        }

        fetch(form.action, {
          method: "POST",
          body: formData,
        })
          .then((response) => {
            if (response.ok) {
              form.style.display = "none";
              document.getElementById("success-message").style.display = "block";
            } else {
              alert("There was a problem submitting the form.");
            }
          })
          .catch((error) => {
            console.error("Error!", error);
            alert("There was an error. Please try again.");
          });
      });
    });
  </script>
</body>
</html>
