<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>BinButler Service Questions</title>
  <link rel="stylesheet" href="loggedin.css" />
</head>
<body>
  <nav class="navbar">
    <div class="logo">
      <a href="index.html">Arch bin</a>
    </div>
  </nav>

  <div class="container">
    <header>
      <h1>BinButler Service Signup</h1>
    </header>

    <main>
      <form
        id="signupForm"
        action="https://script.google.com/macros/s/AKfycbyz0bU9beQmZ6nasZ5B_g6Mr_yH9rsacI-Mj5Fvobg8e2rpYycZX02nuWpq8Rg0ObfGbQ/exec"
        method="POST"
      >
        <!-- Question 1 -->
        <section>
          <h2>1. What is your address for bin service?</h2>
          <input type="text" name="address" placeholder="Enter your address" required />
        </section>

        <!-- Question 2 -->
        <section>
          <h2>2. Where are the bins currently located on your property?</h2>

          <!-- NOTE: id="bin_location" is required by the JS -->
          <select id="bin_location" name="bin_location" required>
            <option value="" disabled selected>Select bin location</option>
            <option value="backyard">Backyard</option>
            <option value="side_yard">Side Yard</option>
            <option value="garage">Garage</option>
            <option value="other">Other</option>
          </select>

          <!-- Hidden textbox: will appear only when "Other" is selected -->
          <input
            type="text"
            id="other_location"
            name="other_location"
            placeholder="Please specify where your bins are located..."
            style="display:none; margin-top:10px;"
            aria-hidden="true"
          />
        </section>

        <!-- Question 3 -->
        <section>
          <h2>3. Do you have pets we should be aware of?</h2>
          <select name="pets" required>
            <option value="" disabled selected>Select an option</option>
            <option value="yes">Yes</option>
            <option value="no">No</option>
          </select>
        </section>

        <!-- Question 4 -->
        <section>
          <h2>4. What is your preferred payment method?</h2>
          <select name="payment_method" required>
            <option value="" disabled selected>Select a payment method</option>
            <option value="PayPal">PayPal</option>
            <option value="Cash">Cash</option>
          </select>
        </section>

        <!-- Question 5 -->
        <section>
          <h2>5. What is your preferred contact method?</h2>
          <select name="contact_method" required>
            <option value="" disabled selected>Select a contact method</option>
            <option value="email">Email</option>
            <option value="text">Text Message</option>
          </select>
          <input type="text" name="contact_info" placeholder="Enter your phone or email" required />
        </section>

        <!-- Question 6 -->
        <section>
          <h2>6. Do we have permission to access your property?</h2>
          <select name="property_access" required>
            <option value="" disabled selected>Select an option</option>
            <option value="yes">Yes</option>
          </select>
        </section>

        <!-- Submit Button -->
        <section>
          <button type="submit">Submit</button>
        </section>
      </form>

      <!-- Success Message -->
      <div id="success-message" style="display: none; text-align: center; margin-top: 20px;">
        <h2>Thank you! Weâ€™ve received your info ðŸ§¹</h2>
        <p>Weâ€™ll contact you soon to start your BinButler service!</p>
      </div>
    </main>
  </div>

  <!-- Scripts -->
  <script>
    document.addEventListener("DOMContentLoaded", function () {
      // Elements
      const binSelect = document.getElementById("bin_location");
      const otherInput = document.getElementById("other_location");
      const form = document.getElementById("signupForm");

      // Toggle function
      function toggleOtherField() {
        if (!binSelect || !otherInput) return;
        if (binSelect.value === "other") {
          otherInput.style.display = "block";
          otherInput.required = true;
          otherInput.setAttribute("aria-hidden", "false");
        } else {
          otherInput.style.display = "none";
          otherInput.required = false;
          otherInput.value = "";
          otherInput.setAttribute("aria-hidden", "true");
        }
      }

      // Run on change and once on load (handles back/forward or pre-filled)
      binSelect.addEventListener("change", toggleOtherField);
      toggleOtherField();

      // Existing submit handler (kept inside DOMContentLoaded)
      form.addEventListener("submit", function (e) {
        e.preventDefault();
        const formData = new FormData(form);

        fetch(form.action, {
          method: "POST",
          body: formData,
        })
          .then((response) => {
            if (response.ok) {
              form.style.display = "none";
              document.getElementById("success-message").style.display = "block";
            } else {
              alert("There was a problem submitting the form.");
            }
          })
          .catch((error) => {
            console.error("Error!", error);
            alert("There was an error. Please try again.");
          });
      });
    });
  </script>
</body>
</html>
